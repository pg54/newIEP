<template>
    <div class="main">
        <div class="pageNavbar">
            <span style="color: black">当前位置&nbsp;&nbsp;>&nbsp;&nbsp;</span>
            <span @click="backroute">{{ tabs[currentTab] }}&nbsp;&nbsp;>&nbsp;&nbsp;</span>
            <span v-if=" currentTab === 2 && testStatuses[1] ">开始评测</span>
            <span v-if=" currentTab === 2 && !testStatuses[0] && !testStatuses[1]" @click="gobackTestList">评估列表&nbsp;&nbsp;>&nbsp;&nbsp;</span>
            <span v-show=" currentTab === 2 && testStatuses[3] ">
                <span style="color: rgba(49, 187, 252, 1)">{{ chosedPatient}}</span>的评估结果&nbsp;&nbsp;>&nbsp;&nbsp;</span>
            <span v-show=" currentTab === 2 && testStatuses[4] ">
                <span style="color: rgba(49, 187, 252, 1)">{{ chosedPatient}}</span>的评估报告&nbsp;&nbsp;>&nbsp;&nbsp;</span>
            <span v-if=" currentTab === 5 && !CPEPVisible[0] && !CPEPVisible[2] && !cpepSratus">开始评测</span>
            <span v-if=" currentTab === 5 && !CPEPVisible[0] && !CPEPVisible[2] && cpepSratus">评测详情</span>
            <span v-if=" currentTab === 5 && !CPEPVisible[0] && !CPEPVisible[1] ">已评测列表</span>

            <span v-if=" currentTab === 6 && testStatuses[1] ">开始评测</span>
            <span v-if=" currentTab === 6 && !entranceStatuses[0] && !entranceStatuses[1]" @click="gobackEntranceList">评估列表&nbsp;&nbsp;>&nbsp;&nbsp;</span>
            <span v-show=" currentTab === 6 && entranceStatuses[3] ">
                <span style="color: rgba(49, 187, 252, 1)">{{ chosedPatient}}</span>的评估结果&nbsp;&nbsp;>&nbsp;&nbsp;</span>
            <span v-show=" currentTab === 6 && entranceStatuses[4] ">
                <span style="color: rgba(49, 187, 252, 1)">{{ chosedPatient}}</span>的评估报告&nbsp;&nbsp;>&nbsp;&nbsp;</span>
        </div>
        <div class="tabs" v-show="tabsShow">
            <div class="tabs-chose">
                <li v-for="(tab, index) in tabs" :class="{active : currentTab === index }" @click="currentTab = index;CPEPVisible = [true,false,false];choseCPEPvisible = false;testStatuses = [true,false,false,false,false];">{{tab}}
                </li>
            </div>
            <div class="tabs-content">
                <!--动态-->
                <div v-show="currentTab === 0" class="tab-content">
                    <ServiceDyma></ServiceDyma>
                </div>
                <!--咨询管理-->
                <div v-show="currentTab === 1" class="tab-content">
                    <div class="center-content">
                        <div class="toolBox">
                            <el-button @click="toAddPaper(21)">
                                <Icon type="plus-round"></Icon>添加表格
                            </el-button>
                        </div>
                        <el-card class="cardBox colorHeader" :body-style="{ padding: '0px'}">
                            <div class="tableWrap">
                                <el-table :data="consultData" style="width: 100%">
                                    <el-table-column type="index" width="60">
                                    </el-table-column>

                                    <el-table-column prop="Name" label="名称" width="180">
                                    </el-table-column>
                                    <el-table-column prop="TotalCount" label="已发送个数" width="180">
                                    </el-table-column>
                                    <el-table-column prop="FinishedCount" label="已完成个数">
                                    </el-table-column>
                                    <el-table-column prop="CreatedOn" label="创建时间">
                                    </el-table-column>

                                    <el-table-column label="操作">
                                        <template scope="scope">
                                            <el-button size="mini" :plain="true" type="info" @click="checkPaper(scope.$index, scope.row)">查看填写结果</el-button>
                                            <el-button size="mini" :plain="true" type="warning" @click="sendtoPaticent(scope.$index, scope.row)">发放</el-button>
                                        </template>
                                    </el-table-column>
                                </el-table>
                            </div>
                        </el-card>
                    </div>
                </div>

                <!--评测管理-->
                <div v-show="currentTab === 2" class="tab-content testManager">
                    <!--<div class="center-content" style="height: 580px">-->
                    <!--<div class="testList" style="height: 580px">-->
                    <div v-if="testStatuses[0]">
                        <div class="toolBox">
                            <el-button @click="addTestPaper">
                                <Icon type="plus-round"></Icon>新建评估表
                            </el-button>
                        </div>
                        <el-card class="cardBox colorHeader" :body-style="{ padding: '0px'}">
                            <div class="tableWrap" style="height: 480px">
                                <el-table :data="testPaperListData" style="width: 100%">
                                    <el-table-column type="index" width="70">
                                    </el-table-column>

                                    <el-table-column prop="Name" label="名称" width="160">
                                    </el-table-column>

                                    <el-table-column prop="PackageName" label="课程包名称">
                                    </el-table-column>

                                    <el-table-column prop="CreatedOn" label="创建时间">
                                    </el-table-column>

                                    <el-table-column label="操作">
                                        <template scope="scope">
                                            <el-button size="mini" :plain="true" type="info" @click="startTest(scope.$index, scope.row)">开始新评测</el-button>
                                            <el-button size="mini" :plain="true" type="warning" @click="checkTestPaticent(scope.$index, scope.row)">已评测患者</el-button>
                                            <el-button size="mini" :plain="true" type="danger" @click="deleteExam(scope.$index, scope.row, false)">删除</el-button>
                                        </template>
                                    </el-table-column>

                                </el-table>
                            </div>
                            <el-pagination layout="prev, pager, next" @current-change="testPaperListChange" :page-size="10" :total="testPaperTotal" style="float:right;"></el-pagination>
                        </el-card>
                    </div>
                    <div v-if="testStatuses[1]" class="moveLeft">
                        <!--<TestPaper :course_id="paperCourseID" :patiend_id="paperPatientID" :examID="paperExamID"></TestPaper>-->
                        <TestResult :paticentID="resultPaticentID" :testID="resultTestID" :isComplete="completeTest"></TestResult>
                    </div>
                    <div v-if="testStatuses[2]" class="testStudent" style="z-index: 100">
                        <el-card class="newCardBox colorHeader" :body-style="{ padding: '0px'}">
                            <div class="tableWrap">
                                <el-table :data="testedPatientListData" style="width: 100%">
                                    <el-table-column type="index" width="80">
                                    </el-table-column>

                                    <el-table-column prop="ExamName" label="评测名称">
                                    </el-table-column>

                                    <el-table-column prop="Name" label="姓名">
                                    </el-table-column>

                                    <el-table-column label="操作" width="300">
                                        <template scope="scope">
                                            <el-button v-if="!scope.row.Status" size="mini" :plain="true" type="info" @click="checkPacientTestDetail(scope.$index, scope.row, false, false)">继续评测</el-button>
                                            <el-button v-if="!scope.row.Status" size="mini" :plain="true" type="info" @click="toDeleteExamPatient(scope.$index, scope.row, false)">删除</el-button>
                                            <el-button v-if="scope.row.Status" size="mini" :plain="true" type="info" @click="checkPacientTestresult(scope.$index, scope.row, true, false)">分析表</el-button>
                                            <el-button v-if="scope.row.Status" size="mini" :plain="true" type="info" @click="checkPacientTestReport(scope.$index, scope.row, false)">评估报告</el-button>
                                        </template>
                                    </el-table-column>

                                </el-table>

                            </div>
                            <el-pagination layout="prev, pager, next" @current-change="testedPatientListNextPage" :page-size="10" :total="testedPatientListTotal"
                                style="float:right;"></el-pagination>
                        </el-card>
                    </div>
                    <div v-if="testStatuses[3]" class="moveLeft">
                        <TestResult :paticentID="resultPaticentID" :testID="resultTestID" :isComplete="completeTest"></TestResult>
                    </div>
                    <div v-if="testStatuses[4]" class="moveLeft">
                        <TestReport :testID="reportID" :paticentID="reportPaticentID"></TestReport>
                    </div>
                </div>

                <!--训练管理-->
                <div v-show="currentTab === 3">
                    <div class="center-content">
                        <div class="toolBox">
                            <el-button @click="toAddPaper(41)">
                                <Icon type="plus-round"></Icon>添加表格
                            </el-button>
                        </div>
                        <el-card class="cardBox colorHeader " :body-style="{ padding: '0px'}">
                            <div class="tableWrap">
                                <el-table :data="trainingData" style="width: 100%">
                                    <el-table-column type="index" width="70">
                                    </el-table-column>

                                    <el-table-column prop="Name" label="名称" width="180">
                                    </el-table-column>
                                    <el-table-column prop="TotalCount" label="已发送个数" width="180">
                                    </el-table-column>
                                    <el-table-column prop="FinishedCount" label="已完成个数">
                                    </el-table-column>
                                    <el-table-column prop="CreatedOn" label="创建时间">
                                    </el-table-column>

                                    <el-table-column label="操作">
                                        <template scope="scope">
                                            <el-button size="mini" :plain="true" type="info" @click="checkPaper(scope.$index, scope.row)">查看填写结果</el-button>
                                            <el-button size="mini" :plain="true" type="warning" @click="sendtoPaticent(scope.$index, scope.row)">发放</el-button>
                                        </template>
                                    </el-table-column>

                                </el-table>
                            </div>
                        </el-card>
                    </div>
                </div>

                <!--随访中心-->
                <div v-show="currentTab === 4">
                    <vueTab :tabtitles="['反馈表','复查表','关心提醒']" :current-page="1">
                        <div class="tab-content-container">
                            <div class="center-content">
                                <div class="toolBox">
                                    <el-button @click="toAddPaper(11)">
                                        <Icon type="plus-round"></Icon>添加表格
                                    </el-button>
                                </div>
                                <el-card class="cardBox colorHeader shortLength" :body-style="{ padding: '0px'}">
                                    <div class="tableWrap" style="overflow-y: scroll">
                                        <el-table :data="feedbackData" style="width: 100%">
                                            <el-table-column type="index" width="70">
                                            </el-table-column>

                                            <el-table-column prop="Name" label="名称" width="180">
                                            </el-table-column>
                                            <el-table-column prop="TotalCount" label="已发送个数" width="180">
                                            </el-table-column>
                                            <el-table-column prop="FinishedCount" label="已完成个数">
                                            </el-table-column>
                                            <el-table-column prop="CreatedOn" label="创建时间">
                                            </el-table-column>

                                            <el-table-column label="操作">
                                                <template scope="scope">
                                                    <el-button size="mini" :plain="true" type="info" @click="checkPaper(scope.$index, scope.row)">查看填写结果</el-button>
                                                    <el-button size="mini" :plain="true" type="warning" @click="sendtoPaticent(scope.$index, scope.row)">发放</el-button>
                                                </template>
                                            </el-table-column>

                                        </el-table>
                                    </div>
                                </el-card>
                            </div>
                        </div>
                        <div class="tab-content-container">
                            <div class="center-content">

                                <div class="toolBox">
                                    <el-button @click="toAddPaper(12)">
                                        <Icon type="plus-round"></Icon>添加表格
                                    </el-button>

                                </div>
                                <el-card class="cardBox colorHeader shortLength" :body-style="{ padding: '0px'}">
                                    <div class="tableWrap">
                                        <el-table :data="reviewData" style="width: 100%">
                                            <el-table-column type="index" width="50">
                                            </el-table-column>

                                            <el-table-column prop="Name" label="名称" width="180">
                                            </el-table-column>
                                            <el-table-column prop="TotalCount" label="已发送个数" width="180">
                                            </el-table-column>
                                            <el-table-column prop="FinishedCount" label="已完成个数">
                                            </el-table-column>
                                            <el-table-column prop="CreatedOn" label="创建时间">
                                            </el-table-column>

                                            <el-table-column label="操作">
                                                <template scope="scope">
                                                    <el-button size="mini" :plain="true" type="info" @click="checkPaper(scope.$index, scope.row)">查看填写结果</el-button>
                                                    <el-button size="mini" :plain="true" type="warning" @click="sendtoPaticent(scope.$index, scope.row)">发放</el-button>
                                                </template>
                                            </el-table-column>

                                        </el-table>
                                    </div>
                                </el-card>
                            </div>
                        </div>
                        <div class="tab-content-container">
                            <div class="center-content">

                                <div class="toolBox">
                                    <el-button @click="toAddPaper(13)">
                                        <Icon type="plus-round"></Icon>添加表格
                                    </el-button>
                                </div>
                                <el-card class="cardBox colorHeader shortLength" :body-style="{ padding: '0px'}">
                                    <div class="tableWrap">
                                        <el-table :data="remindData" style="width: 100%">
                                            <el-table-column type="index" width="80">
                                            </el-table-column>

                                            <el-table-column prop="Name" label="名称" width="180">
                                            </el-table-column>
                                            <el-table-column prop="TotalCount" label="已发送个数" width="180">
                                            </el-table-column>
                                            <el-table-column prop="FinishedCount" label="已完成个数">
                                            </el-table-column>
                                            <el-table-column prop="CreatedOn" label="创建时间">
                                            </el-table-column>

                                            <el-table-column label="操作">
                                                <template scope="scope">
                                                    <el-button size="mini" :plain="true" type="info" @click="checkPaper(scope.$index, scope.row)">查看填写结果</el-button>
                                                    <el-button size="mini" :plain="true" type="warning" @click="sendtoPaticent(scope.$index, scope.row)">发放</el-button>
                                                </template>
                                            </el-table-column>
                                        </el-table>
                                    </div>
                                </el-card>
                            </div>
                        </div>
                    </vueTab>
                </div>

                <div v-show="currentTab === 5">
                    <div class="cpepContentWrap">
                        <div class="center-content">
                            <el-card v-if="CPEPVisible[0]" class="cardBox colorHeader" :body-style="{ padding: '0px'}">
                                <div class="tableWrap" style="height: 480px">
                                    <el-table :data="CPEPdata" style="width: 100%">

                                        <el-table-column prop="Name" label="名称">
                                        </el-table-column>

                                        <el-table-column prop="CreatedOn" label="创建时间">
                                        </el-table-column>

                                        <el-table-column label="操作">
                                            <template scope="scope">
                                                <el-button size="mini" :plain="true" type="info" @click="startCPEPTest">开始测试</el-button>
                                                <el-button size="mini" :plain="true" type="warning" @click="checkTestedMembers">已评测患者</el-button>
                                            </template>
                                        </el-table-column>

                                    </el-table>
                                </div>
                                <el-pagination layout="prev, pager, next" @current-change="testPaperListChange" :page-size="10" :total="testPaperTotal" style="float:right;"></el-pagination>
                            </el-card>
                            <div v-if="CPEPVisible[1]">
                                <div class="cpepWrap cpep_scrollbar">
                                    <serviceCPEP :cpepData="cpepSdata" :pacientID="choseToTestPatient" :isResultPage="cpepSratus" :isFirstTimeTest="cpepFirstTest" :cpepMemberID="cpMemberID"></serviceCPEP>
                                </div>
                            </div>
                            <div v-if="CPEPVisible[2]">
                                <el-card class="cardBox colorHeader" :body-style="{ padding: '0px'}">
                                    <div class="tableWrap">
                                        <el-table :data="cpepMemdbersData.Records" style="width: 100%">
                                            <el-table-column type="index" width="60">
                                            </el-table-column>

                                            <el-table-column prop="PatientAgentName" label="名称" width="180">
                                            </el-table-column>

                                            <el-table-column prop="ModifiedOn" label="修改时间">
                                            </el-table-column>

                                            <el-table-column prop="CreatedOn" label="创建时间">
                                            </el-table-column>

                                            <el-table-column label="操作">
                                                <template scope="scope">
                                                    <!-- <span>{{ scope }}</span> -->
                                                    <el-button v-if="scope.row.Status === 0" size="mini" :plain="true" type="info" @click="continueCPEPTest(scope.$index, scope.row)">继续评测</el-button>
                                                    <el-button v-else size="mini" :plain="true" type="info" @click="checkCPEPResult(scope.$index, scope.row)">查看填写结果</el-button>
                                                </template>
                                            </el-table-column>
                                        </el-table>
                                    </div>
                                </el-card>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 入学评测 -->
                <div v-show="currentTab === 6" class="tab-content testManager">
                    <div v-if="entranceStatuses[0]">
                        <div class="toolBox">
                            <el-button @click="addEntrancePaper">
                                <Icon type="plus-round"></Icon>新建评估表
                            </el-button>
                        </div>
                        <el-card class="cardBox colorHeader" :body-style="{ padding: '0px'}">
                            <div class="tableWrap" style="height: 480px">
                                <el-table :data="entranceListData" style="width: 100%">
                                    <el-table-column type="index" width="70">
                                    </el-table-column>

                                    <el-table-column prop="Name" label="名称" width="160">
                                    </el-table-column>

                                    <el-table-column prop="PackageName" label="课程包名称">
                                    </el-table-column>

                                    <el-table-column prop="CreatedOn" label="创建时间">
                                    </el-table-column>

                                    <el-table-column label="操作">
                                        <template scope="scope">
                                            <el-button size="mini" :plain="true" type="info" @click="startNewEnterance(scope.$index, scope.row)">开始新评测</el-button>
                                            <el-button size="mini" :plain="true" type="warning" @click="checkEntrancePaticent(scope.$index, scope.row)">已评测患者</el-button>
                                            <el-button size="mini" :plain="true" type="danger" @click="deleteExam(scope.$index, scope.row, true)">删除</el-button>
                                        </template>
                                    </el-table-column>

                                </el-table>
                            </div>
                            <el-pagination layout="prev, pager, next" @current-change="testPaperListChange" :page-size="10" :total="testPaperTotal" style="float:right;"></el-pagination>
                        </el-card>
                    </div>
                    <div v-if="entranceStatuses[1]" class="moveLeft">
                        <!--<TestPaper :course_id="paperCourseID" :patiend_id="paperPatientID" :examID="paperExamID"></TestPaper>-->
                        <TestResult :paticentID="resultPaticentID" :testID="resultTestID" :isComplete="completeTest"></TestResult>
                    </div>
                    <div v-if="entranceStatuses[2]" class="testStudent" style="z-index: 100">
                        <el-card class="newCardBox colorHeader" :body-style="{ padding: '0px'}">
                            <div class="tableWrap">
                                <el-table :data="entranceedPatientListData" style="width: 100%">
                                    <el-table-column type="index" width="80">
                                    </el-table-column>

                                    <el-table-column prop="ExamName" label="评测名称">
                                    </el-table-column>

                                    <el-table-column prop="Name" label="姓名">
                                    </el-table-column>

                                    <el-table-column label="操作" width="300">
                                        <template scope="scope">
                                            <el-button v-if="!scope.row.Status" size="mini" :plain="true" type="info" @click="checkPacientTestDetail(scope.$index, scope.row, false, true)">继续评测</el-button>
                                            <el-button v-if="!scope.row.Status" size="mini" :plain="true" type="info" @click="toDeleteExamPatient(scope.$index, scope.row, true)">删除</el-button>
                                            <el-button v-if="scope.row.Status" size="mini" :plain="true" type="info" @click="checkPacientTestresult(scope.$index, scope.row, true, true)">分析表</el-button>
                                            <el-button v-if="scope.row.Status" size="mini" :plain="true" type="info" @click="checkPacientTestReport(scope.$index, scope.row, true)">评估报告</el-button>
                                        </template>
                                    </el-table-column>

                                </el-table>

                            </div>
                            <el-pagination layout="prev, pager, next" @current-change="entrancedPatientListNextPage" :page-size="10" :total="entranceedPatientListTotal"
                                style="float:right;"></el-pagination>
                        </el-card>
                    </div>
                    <div v-if="entranceStatuses[3]" class="moveLeft">
                        <TestResult :paticentID="resultPaticentID" :testID="resultTestID" :isComplete="completeTest"></TestResult>
                    </div>
                    <div v-if="entranceStatuses[4]" class="moveLeft">
                        <TestReport :testID="reportID" :paticentID="reportPaticentID"></TestReport>
                    </div>
                </div>
            </div>
        </div>
        <router-view :key="key"></router-view>

        <el-dialog title="发送问卷" v-model="sendToPaticentVisible" :close-on-click-modal="false" @close="resetPatientList" :show-close="false">
            <el-select v-model="selectedPacientIDS" placeholder="请选择小组" @change="filterPacient">
                <el-option v-for="(item, index) in selectedGroup" :key="item.groupName" :label=item.groupName :value=index>
                </el-option>
            </el-select>

            <el-select v-model="pacientsIDS" placeholder="请选择患者" ref="pacientesSelecter">
                <el-option v-for="(item, index) in selectedGroupPacientes" :key="item.Name" :label=item.Name :value=item.ID>
                </el-option>
            </el-select>

            <div slot="footer" class="dialog-footer">
                <el-button @click.native="sendToPaticentVisible = false">返回</el-button>
                <el-button type="primary" class="transBtn" @click="sendToPacientSubmit()">发送</el-button>
            </div>
        </el-dialog>

        <el-dialog title="选择患者" v-model="choseToTestVisible" :close-on-click-modal="false" @close="resetChosePatientTest" :show-close="false">

            <el-select v-model="selectedPacientIDS" placeholder="请选择小组" @change="filterPacient">
                <el-option v-for="(item, index) in selectedGroup" :key="item.groupName" :label=item.groupName :value=index>
                </el-option>
            </el-select>

            <el-select v-model="choseToTestPatient" placeholder="请选择患者">
                <el-option v-for="(item, index) in selectedGroupPacientes" :key="item.Name" :label=item.Name :value=item.ID>
                </el-option>
            </el-select>

            <div slot="footer" class="dialog-footer">
                <el-button @click.native="choseToTestVisible = false">返回</el-button>
                <el-button type="primary" class="testPaper" @click="choseToTestSubmit('yy', false)">评测开始</el-button>
            </div>
        </el-dialog>

        <el-dialog title="入学评测选择患者" v-model="choseToEntranceTestVisible" :close-on-click-modal="false" @close="resetChosePatientTest" :show-close="false">

            <el-select v-model="selectedPacientIDS" placeholder="请选择小组" @change="filterPacient">
                <el-option v-for="(item, index) in selectedGroup" :key="item.groupName" :label=item.groupName :value=index>
                </el-option>
            </el-select>

            <el-select v-model="choseToTestPatient" placeholder="请选择患者">
                <el-option v-for="(item, index) in selectedGroupPacientes" :key="item.Name" :label=item.Name :value=item.ID>
                </el-option>
            </el-select>

            <div slot="footer" class="dialog-footer">
                <el-button @click.native="choseToTestVisible = false">返回</el-button>
                <el-button type="primary" class="testPaper" @click="choseToEntranceTestSubmit('yy', false)">评测开始</el-button>
            </div>
        </el-dialog>

        <el-dialog title="已发送问卷" v-model="replyPatientListVisible" :close-on-click-modal="false">
            <el-table :data="editedPaperData" style="width: 100%">
                <el-table-column type="index">
                </el-table-column>

                <el-table-column prop="PatientName" label="姓名">
                </el-table-column>

                <el-table-column prop="Status" label="状态">
                    <template scope="scope">
                        <span>{{scope.row.Status?'已完成':'未完成'}}</span>
                    </template>
                </el-table-column>

                <el-table-column prop="PaperName" label="表名">
                </el-table-column>

                <el-table-column prop="CreatedOn" label="创建时间" show-overflow-tooltip>
                </el-table-column>
                <el-table-column label="操作">
                    <template scope="scope">
                        <el-button size="mini" :plain="true" type="info" @click="previewEditedForm(scope.$index, scope.row)">查看</el-button>
                    </template>
                </el-table-column>
            </el-table>

            <el-pagination layout="prev, pager, next" @current-change="reslutCurrentChange" :page-size="10" :total="resultTotal" style="float:right;"></el-pagination>

        </el-dialog>

        <el-dialog v-model="previewFormVisible" :close-on-click-modal="false" :show-close="false">
            <div class="paperContent">
                <QuestionPaper></QuestionPaper>
            </div>
            <div slot="footer" class="dialog-footer">
                <el-button @click.native="previewFormVisible = false">返回</el-button>
            </div>
        </el-dialog>

        <el-dialog title="模板列表" v-model="createQuestionnaireVisible" :close-on-click-modal="false" :show-close="false">

            <el-table :data="paperTmeplateData" style="width: 100%">
                <el-table-column type="index" width="50">
                </el-table-column>

                <el-table-column prop="Name" label="名称" width="180">
                </el-table-column>

                <el-table-column prop="Comments" label="内容" width="180">
                </el-table-column>

                <el-table-column label="操作">
                    <template scope="scope">
                        <el-button size="mini" :plain="true" type="info" @click="addForm(scope.$index, scope.row)">添加</el-button>
                        <el-button size="mini" :plain="true" type="warning" @click="previewForm(scope.$index, scope.row)">查看</el-button>
                    </template>
                </el-table-column>

            </el-table>

            <div slot="footer" class="dialog-footer">
                <el-button @click.native="createQuestionnaireVisible = false">返回</el-button>
            </div>
        </el-dialog>

        <el-dialog title="模板列表" v-model="addTestPaperVisible" :close-on-click-modal="false" @close="entrancePaperCancel">
            <div class="addTestFormWrap">
                <el-form ref="addTestform" :model="testFormData" label-width="100px">
                    <el-form-item label="名称">
                        <el-input v-model="testFormData.Name" type="mini" style="width: 100%"></el-input>
                    </el-form-item>
                    <el-form-item label="课程包">
                        <el-select v-model="testFormData.PaperPackageID" placeholder="请选择课程包" style="width: 100%">
                            <el-option v-for="o in testPaperData" :label="o.Name" :value="o.ID"></el-option>
                        </el-select>
                    </el-form-item>
                    <el-form-item label="添加课程包:">
                        <el-collapse v-model="activeName" accordion>
                            <el-collapse-item title="" name="1">
                                <div class="checkBoxWrap">
                                    <el-row :gutter="10">
                                        <el-col :span="16">
                                            <input class="onc-input" style="margin-left: 15px" placeholder="请输入课程包名" v-model="addPackageOBJ.Name">
                                        </el-col>
                                        <el-col :span="8">
                                            <el-button style="margin-left: 15px" @click="createNewPakage()">确认</el-button>
                                        </el-col>
                                    </el-row>

                                    <el-checkbox-group v-model="addPackageOBJ.Courses">
                                        <el-checkbox v-for="item in courseData" :label="item.ID" class="courseCheckBox">{{ item.Name }}</el-checkbox>
                                    </el-checkbox-group>
                                </div>
                            </el-collapse-item>
                        </el-collapse>
                    </el-form-item>
                </el-form>
            </div>
            <div class="addTestsubmit">
                <el-button @click.native="submitTestPaper">确认</el-button>
            </div>
        </el-dialog>

        <el-dialog title="" v-model="testPaperContentVisible" :close-on-click-modal="false" :show-close="false">

            <el-form>
                <div v-for="paper in testPaperContentData.Papers">
                    <h2>试卷名: {{paper.Name}}</h2>
                    <div v-for="section in paper.Sections">
                        <h3>章节: {{section.Name}}</h3>
                        <div v-for="question in section.Questions">
                            <p>{{ question.Description}}</p>
                            <p>{{ question.ID}}</p>
                            <el-radio-group v-model="questionAnswers.Result">
                                <el-radio v-for="option in question.Options" :key="option.Sequence" :label="option.Sequence">{{option.Name}}</el-radio>
                            </el-radio-group>
                        </div>
                    </div>
                </div>
            </el-form>
        </el-dialog>

        <el-dialog title="选择患者" v-model="choseCPEPvisible" :close-on-click-modal="false" :show-close="false">

            <el-select v-model="selectedPacientIDS" placeholder="请选择小组" @change="filterPacient">
                <el-option v-for="(item, index) in selectedGroup" :key="item.groupName" :label=item.groupName :value=index>
                </el-option>
            </el-select>

            <el-select v-model="choseToTestPatient" placeholder="请选择患者">
                <el-option v-for="(item, index) in selectedGroupPacientes" :key="item.Name" :label=item.Name :value=item.ID>
                </el-option>
            </el-select>

            <div slot="footer" class="dialog-footer">
                <el-button @click.native="choseCPEPvisible = false">返回</el-button>
                <el-button type="primary" class="testPaper" @click="choseToCPEP">开始评测</el-button>
            </div>
        </el-dialog>


        <el-dialog title="入学评测" v-model="addEntranceTestVisible" :close-on-click-modal="false" @close="testPaperCancel">
            <div class="addTestFormWrap">
                <el-form ref="addTestform" :model="entranceFormData" label-width="100px">
                    <el-form-item label="名称">
                        <el-input v-model="entranceFormData.Name" type="mini" style="width: 100%"></el-input>
                    </el-form-item>
                    <el-form-item label="课程包">
                        <el-select v-model="entranceFormData.PaperPackageID" placeholder="请选择课程包" style="width: 100%">
                            <el-option v-for="o in entrancePackageData" :label="o.Name" :value="o.ID"></el-option>
                        </el-select>
                    </el-form-item>
                </el-form>
            </div>
            <div class="addTestsubmit">
                <el-button @click.native="submitEntrancePaper">确认</el-button>
            </div>
        </el-dialog>

    </div>
</template>
<script>
    import QuestionPaper from '../../components/QuestionPaper.vue';
    import TestPaper from './child/testPaper.vue';
    import TestResult from '../../components/resultPaper.vue';
    import TestReport from '../../components/reportPaper.vue';
    import ServiceDyma from './MyServiceDyma/MyServiceDyma.vue';
    import vueTab from '../../components/vue-tab.vue';
    import serviceCPEP from '../../components/serviceCPEP.vue';
    import api from '../../api/index.js';
    export default {
        name: 'ServiceTool',
        components: {
            ServiceDyma,
            QuestionPaper,
            vueTab,
            TestPaper,
            TestResult,
            TestReport,
            serviceCPEP
        },
        computed: {
            key() {
                if (this.$router.currentRoute.path == '/serviceTool') {
                    this.tabsShow = true;
                    this.jumptoIepPlan();
                }
                return this.$route.name !== undefined ? this.$route.name + +new Date() : this.$route + +new Date();
            }
        },
        data() {
            return {
                currentTab: 0,
                tabs: ['动态', '咨询管理', '评测管理', '训练管理', '随访中心', 'CPEP', '入学评测'],
                zxPage: 1,
                pcPage: 1,
                xlPage: 1,
                fkbPage: 1,
                fcPage: 1,
                gxPage: 1,
                resultPage: 1,
                resultTotal: 1,
                studentListVisible: true,
                createQuestionnaireVisible: false,
                replyPatientListVisible: false,
                sendToPaticentVisible: false,
                previewFormVisible: false,
                addTestPaperVisible: false,
                testPaperContentVisible: false,
                testedPatientListVisible: false,
                reportAndResult: false,
                consultData: [], // 咨询管理
                paperConsultURL: '',
                testPaperListData: [], // 评测管理
                CPEPdata: [{
                    Name: '孤独症谱系及相关发育障碍儿童评估用心理教育量表中文修订三版',
                    CreatedOn: '2017-08-31'
                }],
                testPaperTotal: 1,
                testPaperCurrentPage: 1,
                paperEvaluationURL: '',
                trainingData: [], // 训练管理
                paperTrainingURL: '',
                feedbackData: [], // 反馈表
                paperFeedbackURL: '',
                reviewData: [], // 负责复评
                paperReviewURL: '',
                remindData: [], // 关心提醒,
                paperRemindURL: '',
                testPaperContentData: [], // 评测内容data
                paperTmeplateData: [],
                testPaperData: [],
                editedPaperData: [],
                patientOptions: [],
                selectedOptions: '',
                activeName: 'first',
                sendListID: '',
                selectedGroup: this.$store.state.mystudent.patientList, // 患者小组数组
                selectedGroupPacientes: [], // 小组中患者数组
                pacientsIDS: [],
                selectedPacientIDS: '',
                tabsShow: true,
                paperID: '',
                testFormData: {
                    Name: '',
                    PaperPackageID: ''
                },
                addPackageOBJ: {
                    Courses: [],
                    Name: ''
                },
                activeName: '1',
                questionAnswers: [{
                    QuestionID: '',
                    Result: ''
                }],
                courseData: [],
                testedPatientListData: [],
                examID: '',
                examPatientID: '',
                testedPatientListTotal: 1,
                testedPatientCurrentPage: 1,
                choseToTestVisible: false,
                choseCPEPvisible: false, //CPEP
                choseToTestPatient: '',
                paperPackageID: '',
                testID: '',
                testStatuses: [true, false, false, false, false],
                resultPaticentID: '', //结果
                resultTestID: '', //结果
                reportPaticentID: '', //报告
                reportID: '', //报告
                paperCourseID: '', //答题页面
                paperPatientID: '', //答题页面
                paperExamID: '', //答题页面-试卷ID,
                completeTest: false,
                chosedPatient: '', //选中的患者
                consfirmDeleteExamMsg: '',
                cpepSdata: [],
                cpepPid: '',
                CPEPVisible: [true, false, false],
                cpepMemdbersData: '',
                cpepSratus: false,
                addEntranceTestVisible: false,  //入学评测
                choseToEntranceTestVisible: false,
                entranceStatuses: [true, false, false, false, false],
                entrancePackageData: [],
                entranceFormData: {
                    Name: '',
                    PaperPackageID: ''
                },
                entranceListData: [], //入学评测列表数据源
                entrancePaperTotal: 1,
                entrancePaperCurrentPage: 1,
                entranceedPatientListData: [],
                entranceedPatientListTotal: 1,
                entrancedPatientCurrentPage: 1,
                cpMemberID: '',
                cpepFirstTest: true,

            };
        },
        watch: {
            '$route': 'init'
        },
        methods: {
            init() {
                this.studentListVisible = true;
                this.createQuestionnaireVisible = false;
                this.replyPatientListVisible = false;
                this.sendToPaticentVisible = false;
                this.previewFormVisible = false;
                this.addTestPaperVisible = false;
                this.testPaperContentVisible = false;
                this.testedPatientListVisible = false;
                this.tabsShow = true;
                this.choseToTestVisible = false;
                this.requestInitData();
            },
            backroute() {
                this.getTestList(1);
                this.testStatuses = [true, false, false, false, false];
                this.getentranceList(1);
                this.entranceStatuses = [true, false, false, false, false];
                this.CPEPVisible = [true, false, false];
                this.cpepSratus = false;
            },
            gobackTestList() {
                this.testStatuses = [false,false,true,false,false];
                this.requestTestPaticent(this.testedPatientCurrentPage);
            },
            gobackEntranceList() {
                this.entranceStatuses = [false,false,true,false,false];
                this.requestEntrancePaticent(this.entrancedPatientCurrentPage);
            },
            formatStatus: function (row, column) {
                let status = row.Status;
                let statusResult;
                switch (status) {
                    case 0:
                        statusResult = '未完成';
                        break;
                    case 1:
                        statusResult = '已完成';
                        break;
                };
                return statusResult;
            },
            getCheckBoxContents() {
                api.getIEPCourses().then(res => {
                    this.courseData = res.data.List;
                });
            },
            jumptoIepPlan() { // route变化触发
                this.$router.push('/serviceTool');
            },
            checkPacientTestDetail(index, row, isComplete, isEntrance) {
                if (isEntrance) {
                    this.entranceStatuses = [false, false, false, true, false];
                } else {
                    this.testStatuses = [false, false, false, true, false];
                }
                this.resultPaticentID = row.PatientAgentID;
                this.resultTestID = row.ID;
                this.completeTest = isComplete;
                this.chosedPatient = row.Name;
            },
            checkPacientTestresult(index, row, isComplete, isEntrance) {
                if (isEntrance) {
                    this.entranceStatuses = [false, false, false, true, false];
                } else {
                    this.testStatuses = [false, false, false, true, false];
                }
                this.resultPaticentID = row.PatientAgentID;
                this.resultTestID = row.ID;
                this.completeTest = isComplete;
                this.chosedPatient = row.Name;
            },
            checkPacientTestReport(index, row, isEntrance) {
                this.reportID = row.ID;
                this.reportPaticentID = row.PatientAgentID;
                this.chosedPatient = row.Name;
                if (isEntrance) {
                    this.entranceStatuses = [false, false, false, false, true];
                } else {
                    this.testStatuses = [false, false, false, false, true];
                }
                api.getPacientTestReport(this.reportID).then(res => {
                    this.rourseData = res;
                    this.userInfo = res.PatientAgentDetails
                })

            },
            handleClick() {},
            addTestPaper() {
                this.addTestPaperVisible = true;
                api.requestCourseList().then(res => {
                    this.testPaperData = res.List;
                });
            },
            addEntrancePaper() {
                this.addEntranceTestVisible = true;
                api.getEntrancePackage().then(res => {
                    if (res.statusText === 'OK') {
                        this.entrancePackageData = res.data.List;
                    }

                })
            },
            createNewPakage() {
                let CourseIDs = this.addPackageOBJ.Courses.map(function (ele) {
                    let obj = {
                        ID: ele
                    }
                    return obj
                })
                let name = this.addPackageOBJ.Name
                if (CourseIDs.length === 0) {
                    this.$message.warning('请选中课程!');
                    return;
                }
                if (name === "") {
                    this.$message.warning('请输入课程包名称!');
                    return;
                }
                let params = {
                    Courses: CourseIDs,
                    Name: name
                }
                api.addPackage(params).then(res => {
                    if (res.Code === 0) {
                        this.$message.success('课程包添加成功');
                        this.activeName = '2'
                        api.requestCourseList().then(res => {
                            this.testPaperData = res.List;
                        }).catch(err => {
                            this.$message.error('网络错误');
                        })
                    } else {
                        this.$message.warning(res.Msg)
                    }
                }).catch(err => {
                    this.$message.error('网络错误');
                })
            },
            submitTestPaper() {
                let params = this.testFormData;
                api.addTestPaper(params).then(res => {
                    if (res.Code === 0) {
                        this.$message.success('成功');
                        this.addTestPaperVisible = false;
                        this.getTestList(this.testedPatientCurrentPage);
                    } else {
                        this.$message.err('失败');
                    }
                });
            },
            submitEntrancePaper() {
                let params = this.entranceFormData;
                api.addTestPaper(params).then(res => {
                    if (res.Code === 0) {
                        this.$message.success('成功');
                        this.addEntranceTestVisible = false;
                        this.getentranceList(this.entrancePaperCurrentPage);
                    } else {
                        this.$message.warning(res.Msg);
                    }
                });
            },
            resetChosePatientTest() {
                this.selectedPacientIDS = [];
                this.choseToTestPatient = '';
            },
            resetPatientList() {
                this.selectedPacientIDS = [];
                this.pacientsIDS = [];
            },
            testPaperCancel() {
                this.testFormData = {
                    Name: '',
                    PaperPackageID: ''
                }
            },
            entrancePaperCancel() {
                this.addEntranceTestVisible = false;
                this.entranceFormData =  {
                    Name: '',
                    PaperPackageID: ''
                };
            },
            testPaperListChange(currentPage) {
                this.testPaperCurrentPage = currentPage;
                this.getTestList(this.testPaperCurrentPage);
            },
            startTest(index, row) {
                this.paperPackageID = row.PaperPackageID;
                this.testID = row.ID;
                // this.showTestStart = true;
                this.choseToTestVisible = true;
            },
            startNewEnterance(index, row) {
                this.paperPackageID = row.PaperPackageID;
                this.testID = row.ID;
                this.choseToEntranceTestVisible = true;
            },
            choseToTestSubmit(title, isComplete) {
                let params = {
                    ExamID: this.testID,
                    PatientAgentID: this.choseToTestPatient
                };
                api.chosePatientToTest(params).then(res => {
                    if (res.Code === 0) {
                        this.choseToTestVisible = false;
                        this.testStatuses = [false, true, false, false, false];
                        this.resultPaticentID = this.choseToTestPatient;
                        this.resultTestID = res.Msg;
                        this.completeTest = isComplete;
                        this.chosedPatient = title;
                    }
                });
            },
            choseToEntranceTestSubmit(title, isComplete) {
                let params = {
                    ExamID: this.testID,
                    PatientAgentID: this.choseToTestPatient
                };
                api.chosePatientToTest(params).then(res => {
                    if (res.Code === 0) {
                        this.choseToEntranceTestVisible = false;
                        this.entranceStatuses = [false, true, false, false, false];
                        this.resultPaticentID = this.choseToTestPatient;
                        this.resultTestID = res.Msg;
                        this.completeTest = isComplete;
                        this.chosedPatient = title;
                    } else {
                        this.$message.warning('网络异常');
                    }
                });
            },
            startCPEPTest() {
                this.choseCPEPvisible = true;
            },
            checkTestedMembers() {
                this.CPEPVisible = [false, false, true]
                api.getCPEPMember().then(res => {
                    this.cpepMemdbersData = res.data.Data;
                })
            },
            continueCPEPTest(index, row) {
                let params = {
                   testID: row.ID
                }
                api.getCPEP(params).then(res => {
                    if (res.data.Status === true) {
                        this.cpepSdata = res.data.Data;
                        this.cpepFirstTest = false;
                        this.cpMemberID = row.ID;
                        this.CPEPVisible = [false, true, false]
                    }
                })

            },
            checkCPEPResult(index, row) {
                let params = {
                    testId: row.ID,
                    PatientAgentID: row.PatientAgentID,
                    PageIndex: 1,
                    PageSize: 10
                };
                api.getCPEPReport(params).then(res => {
                    this.cpepSdata = res.data.Data.TestResult;
                    this.cpepSratus = true
                    this.CPEPVisible = [false, true, false]
                })
            },
            choseToCPEP() {
                this.choseCPEPvisible = false;
                api.getCPEP().then(res => {
                    if (res.data.Status === true) {
                        this.cpepSdata = res.data.Data;
                        this.CPEPVisible = [false, true, false]
                    }
                })
            },
            checkTestPaticent(index, row) {
                this.examID = row.ID;
                this.requestTestPaticent(1);
            },
            checkEntrancePaticent(index, row) {
                this.examID = row.ID;
                this.requestEntrancePaticent(1);

            },
            requestEntrancePaticent(pageIndex) {
                let params = {
                    ExamID: this.examID,
                    PageIndex: pageIndex,
                    PageSize: 10,
                    PackageType: '2'
                };
                api.requestTestMembers(params).then(res => {
                    this.entranceedPatientListData = res.Records;
                    this.entranceedPatientListTotal = res.Total;
                    //                this.studentListVisible = false;
                });
                this.entranceStatuses = [false, false, true, false, false];
            },
            requestTestPaticent(pageIndex) {
                let params = {
                    ExamID: this.examID,
                    PageIndex: pageIndex,
                    PageSize: 10
                };
                api.requestTestMembers(params).then(res => {
                    this.testedPatientListData = res.Records;
                    this.testedPatientListTotal = res.Total;
                    //                this.studentListVisible = false;
                });
                this.testStatuses = [false, false, true, false, false];
            },
            testedPatientListClose() {
                this.testedPatientListData = '';
            },
            testedPatientListNextPage(currentPage) {
                this.testedPatientCurrentPage = currentPage;
                this.requestTestPaticent(this.testedPatientCurrentPage);
            },
            entrancedPatientListNextPage(currentPage) {
                this.entrancedPatientCurrentPage = currentPage;
                this.requestTestPaticent(this.entrancedPatientCurrentPage);
            },
            previewEditedForm(index, row) {
                var resultID = row.ID;
                api.getPaperResult(resultID).then(res => {
                    this.$store.dispatch('addPaper', res.data);
                    this.previewFormVisible = true;
                });
            },
            toDeleteExamPatient(index, row, isEntrance) {
                this.examPatientID = row.ID
                let params = {
                    ID: this.examPatientID
                };
                api.deleteExamPatient(params).then(res => {
                    if (res.Code === 3) {
                        this.consfirmDeleteExamMsg = res.Msg;
                        this.$confirm('关联数据会被删除, 是否继续?', '提示', {
                            confirmButtonText: '确定',
                            cancelButtonText: '取消',
                            type: 'warning'
                        }).then(() => {
                            this.confirmDeleteExamPatient(isEntrance);
                        });
                    } else if (res.Code === 0) {
                        this.$message.success('删除成功');
                        if (isEntrance) {
                            this.requestEntrancePaticent(this.entrancedPatientCurrentPage);
                        } else {
                            this.requestTestPaticent(this.testedPatientCurrentPage);
                        }

                    } else if (res.Code === 1) {
                        this.$message.warning('指定评估不存在');
                    } else if (res.Code === 2) {
                        this.$message.warning('指定评估不属于当前医生');
                    }
                });
            },
            confirmDeleteExamPatient(isEntrance) {
                let params = {
                    ID: this.examPatientID,
                    key: this.consfirmDeleteExamMsg
                };
                api.deleteExamPatient(params).then(res => {
                    if (res.Code === 0) {
                        this.$message.success('删除成功');
                        if (isEntrance) {
                            this.requestEntrancePaticent(this.entrancedPatientCurrentPage);
                        } else {
                            this.requestTestPaticent(this.testedPatientCurrentPage);
                        }
                    } else if (res.Code === 1) {
                        this.$message.warning('指定评估不存在');
                    } else if (res.Code === 2) {
                        this.$message.warning('指定评估不属于当前医生');
                    }
                });

            },
            deleteExam(index, row, isEntrance) {
                this.examID = row.ID;
                var params = {
                    ID: this.examID
                };
                api.deleteExam(params).then(res => {
                    if (res.Code === 3) {
                        this.consfirmDeleteExamMsg = res.Msg;
                        this.$confirm('关联数据会被删除, 是否继续?', '提示', {
                            confirmButtonText: '确定',
                            cancelButtonText: '取消',
                            type: 'warning'
                        }).then(() => {
                            this.confirmDeleteExam();
                        });
                    } else if (res.Code === 0) {
                        this.$message.warning('删除成功');
                        if (isEntrance) {
                            this.getentranceList(this.entrancePaperCurrentPage);
                        } else {
                            this.getTestList(this.testedPatientCurrentPage);
                        }

                    } else if (res.Code === 1) {
                        this.$message.warning('指定评估不存在');
                    } else if (res.Code === 2) {
                        this.$message.warning('指定评估不属于当前医生');
                    }
                });
            },
            confirmDeleteExam() {
                let params = {
                    ID: this.examID,
                    key: this.consfirmDeleteExamMsg
                };
                api.deleteExam(params).then(res => {
                    if (res.Code === 0) {
                        this.requestInitData();
                        this.$message.success('删除成功');
                    } else if (res.Code === 1) {
                        this.$message.warning('指定评估不存在');
                    } else if (res.Code === 2) {
                        this.$message.warning('指定评估不属于当前医生');
                    }
                });
            },
            previewForm(index, row) {
                var resultID = row.ID;
                api.paperDetails(resultID).then(res => {
                    this.$store.dispatch('addPaper', res.data);
                    this.previewFormVisible = true;
                });
            },
            addForm(index, row) {
                var id = row.ID;
                api.addPapertoDr(id).then(res => {
                    var code = res.Code;
                    switch (code) {
                        case 0:
                            this.$message.success('添加成功');
                            break;
                        case 1:
                            this.$message.warning('指定的表单不存在');
                            break;
                        case 2:
                            this.$message.error('已添加');
                            break;
                    }
                    this.createQuestionnaireVisible = false;
                    this.requestInitData();
                });
            },
            toAddPaper(value) {
                this.createQuestionnaireVisible = true;
                api.filterPaperTmeplate(value).then(res => {
                    this.paperTmeplateData = res.data.List;
                });
            },
            reslutCurrentChange(val) {
                this.resultPage = val;
                this.getDrPaperSendList(this.sendListID, this.resultPage);
            },
            checkPaper(index, row) {
                this.replyPatientListVisible = true;
                this.sendListID = row.ID;
                var id = row.ID;
                this.getDrPaperSendList(id, this.resultPage);
            },
            getDrPaperSendList(id, index) {
                api.getDrPaperSendOut(id, index, 10).then(res => {
                    this.resultTotal = res.data.Total;
                    this.editedPaperData = res.data.Records;
                });
            },
            filterPacient(val) {
                if (this.choseToTestVisible) { //bug,两个选择病人的callback，我用choseToTestVisible区分
                    this.selectedGroupPacientes = this.selectedGroup[val].groupPatients;
                }
                if (this.sendToPaticentVisible) { //bug,两个选择病人的callback，我用choseToTestVisible区分
                    this.selectedGroupPacientes = this.selectedGroup[val].groupPatients;
                }
                if (this.CPEPVisible[0]) { //bug,两个选择病人的callback，我用choseToTestVisible区分
                    this.selectedGroupPacientes = this.selectedGroup[val].groupPatients;
                }
            },
            sendtoPaticent(index, row) {
                this.paperID = row.ID;
                this.sendToPaticentVisible = true;
            },
            sendToPacientSubmit() {
                var params = {
                    PaperID: this.paperID,
                    Patients: [this.pacientsIDS]
                };
                api.sendPaperToPatient(params).then(res => {
                    let code = res.Code;
                    switch (code) {
                        case 0:
                            this.$message.success('发送成功');
                            this.requestInitData();
                            break;
                        case 1:
                            this.$message.warning('指定的问卷不存在');
                            break;
                    }
                    this.sendToPaticentVisible = false;
                });
            },
            handleChange(val) {
                this.selectedOptions = val;
            },
            getPaperData(type, data) {
                var _this = this;
                api.getDrPaperSummary(type).then(res => {
                    _this.paperURL = type;
                    data = res.data.List;
                });
            },
            getTestList(pageIndex) {
                let params = {
                    PageIndex: pageIndex,
                    PageSize: 10
                };
                api.requestTestList(params).then(res => {
                    this.testPaperListData = res.Records;
                    this.testPaperTotal = res.Total;
                });
            },
            getentranceList(pageIndex) {
                let params = {
                    PageIndex: pageIndex,
                    PageSize: 10,
                    PackageType: '2'
                };
                api.requestTestList(params).then(res => {
                    console.log(res.Records)
                    this.entranceListData = res.Records;
                    this.entrancePaperTotal = res.Total;
                });
            },
            requestInitData() {
                this.getTestList(1); // 评测管理
                this.getentranceList(1); // 入学评测
                this.getCheckBoxContents(); //获取课程list
                api.getDrPaperSummary(21).then(res => {
                    this.paperURL = 21;
                    this.consultData = res.data.List;
                });
                api.getDrPaperSummary(41).then(res => {
                    this.paperURL = 41;
                    this.trainingData = res.data.List;
                });
                api.getDrPaperSummary(11).then(res => {
                    this.paperURL = 11;
                    this.feedbackData = res.data.List;
                });
                api.getDrPaperSummary(12).then(res => {
                    this.paperURL = 12;
                    this.reviewData = res.data.List;
                });
                api.getDrPaperSummary(13).then(res => {
                    this.paperURL = 13;
                    this.remindData = res.data.List;
                });
            },
        },

        created() {
            this.requestInitData();
        }
    };

</script>

<style scoped>
    .main {
        position: absolute;
        left: 0;
        top: 0;
    }

    .pageTrack {
        position: absolute;
        width: 100%;
        height: 40px
    }

    .tabs {
        position: absolute;
        top: 42px;
        left: 0;
        width: 100%;
        height: 583px;
        z-index: 5;
    }

    .tabs-chose {
        position: absolute;
        width: 95px;
        height: 583px;
        background-color: #EEEFF0;
        border-right: 1px solid #EFEFEF;
        box-sizing: border-box;
    }

    .tabs-content {
        position: absolute;
        left: 95px;
        top: 0;
        width: 1185px;
        height: 100%;
    }

    .tabs-chose li {
        width: 94px;
        height: 60px;
        background-color: #EEEFF0;
        display: flex;
        cursor: pointer;
        align-items: center;
        justify-content: center;
    }

    .tabs-chose .active {
        background-color: #ffffff;
        color: RGBA(47, 189, 252, 1.00);
        border-left: 6px solid #31BBFC;
    }

    .center-content {
        width: 1125px;
        margin: 0 auto;
    }

    .testManager {
        width: 1125px;
        margin: 0 auto;
    }

    .moveLeft {
        margin-left: -30px;
    }

    .toolBox {
        display: flex;
        justify-content: flex-end;
        margin-top: 5px;
        margin-bottom: 5px;
    }

    .paticentLogo {
        width: 60px;
        height: 60px;
        border-radius: 30px
    }

    .paperContent {
        width: 100%;
        max-height: 600px;
        overflow-y: hidden
    }

    .addTestFormWrap {
        width: 100%;
    }

    .addTestsubmit {
        width: 550px;
        text-align: center;
        margin: 0 auto
    }

    .colorHeader {
        border-top: 4px solid RGBA(49, 187, 252, 1.00)
    }

    .cardBox {
        width: 100%;
        height: 530px;
        margin-top: 10px;
    }

    .newCardBox {
        width: 100%;
        height: 570px;
        margin-top: 10px;
    }

    .tableWrap {
        width: 100%;
        height: 530px;
    }

    .pageNavbar {
        position: absolute;
        left: 0;
        top: 0;
        width: 1280px;
        height: 42px;
        border-bottom: 1px solid #cccccc;
    }

    .heightMaxBox {
        height: 540px;
    }

    .pageNavbar span {
        font-size: 16px;
        cursor: pointer;
        line-height: 42px;
    }

    .pageNavbar span:hover {
        color: rgb(66, 171, 216);
    }

    .shortLength {
        height: 494px
    }

    .longTest {
        height: 560px
    }

    .onc-input {
        -webkit-appearance: none;
        -moz-appearance: none;
        appearance: none;
        background-color: #fff;
        background-image: none;
        border-radius: 4px;
        border: 1px solid #bfcbd9;
        box-sizing: border-box;
        color: #1f2d3d;
        display: block;
        font-size: inherit;
        height: 36px;
        line-height: 1;
        outline: 0;
        padding: 3px 10px;
        transition: border-color .2s cubic-bezier(.645, .045, .355, 1);
        width: 100%;
    }

    .onc-input:focus {
        border: 1px solid rgba(32, 160, 255, 1);
    }

    .courseCheckBox {
        width: 200px;
        height: 40px;
        line-height: 40px;
    }

    .courseCheckBox:nth-child(1) {
        margin-left: 15px
    }

    .cpepWrap {
        width: 100%;
        height: 583px;
        overflow-y: scroll;
    }

    .cpepContentWrap {
        width: 100%;
        height: 583px;
        overflow-y: scroll;
    }
    /*自定义滚动条*/

    .cpep_scrollbar::-webkit-scrollbar {
        width: 8px;
        height: 8px;
        background-color: #F5F5F5;
    }
    /*定义滚动条轨道 内阴影+圆角*/

    .cpep_scrollbar::-webkit-scrollbar-track {
        -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);
        border-radius: 10px;
        background-color: #F5F5F5;
    }
    /*定义滑块 内阴影+圆角*/

    .cpep_scrollbar::-webkit-scrollbar-thumb {
        border-radius: 10px;
        -webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, .3);
        background-color: #20a0ff;
    }

</style>
